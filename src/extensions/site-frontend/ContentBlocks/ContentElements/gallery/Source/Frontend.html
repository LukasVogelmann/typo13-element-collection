<html
    xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers"
    data-namespace-typo3-fluid="true"
>
    <f:layout name="Default" />

    <f:section name="Main">
        <div class="cb-gallery">
            <f:variable name="tabsCount" value="{data.gallery_tab -> f:count()}" />

            <f:if condition="{tabsCount} > 1">
                <div class="tabs">
                    <f:for each="{data.gallery_tab}" as="tab" iteration="i">
                        <div class="tab{f:if(condition: '{i.isFirst}', then: ' active')}" data-gallery-id="{i.index}" >
                            <p>{tab.tabname}</p>
                        </div>
                    </f:for>
                </div>

                <div class="dropdown">
                    <div class="selected">
                        <p>{data.gallery_tab.0.tabname}</p>

                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M5.79289 15.7071C6.18342 16.0976 6.81658 16.0976 7.20711 15.7071L12.5 10.4142L17.7929 15.7071C18.1834 16.0976 18.8166 16.0976 19.2071 15.7071C19.5976 15.3166 19.5976 14.6834 19.2071 14.2929L13.2071 8.29289C12.8166 7.90237 12.1834 7.90237 11.7929 8.29289L5.79289 14.2929C5.40237 14.6834 5.40237 15.3166 5.79289 15.7071Z" fill="#111111"/>
                        </svg>
                    </div>
                    <div class="dropdown-items">
                        <f:for each="{data.gallery_tab}" as="tab" iteration="i">
                            <div class="dropdown-item{f:if(condition: '{i.isFirst}', then: ' active')}" data-gallery-id="{i.index}">
                                <p class="title">{tab.tabname}</p>
                            </div>
                        </f:for>
                    </div>
                </div>
            </f:if>

            <div class="galleries d-none d-tablet-block">
                <f:for each="{data.gallery_tab}" as="tab" iteration="i">
                    <div class="gallery{f:if(condition: '{i.isFirst}', then: ' active')}" data-gallery-id="{i.index}">
                        <f:for each="{tab.gallery_item}" as="item" iteration="j">
                            <f:if condition="{j.index} < 3">
                                <f:then>
                                    <f:render section="ItemWrapper" arguments="{item: item, itemIndex: j.index}" />
                                </f:then>
                            </f:if>
                        </f:for>

                        <div class="column">
                            <f:for each="{tab.gallery_item}" as="item" iteration="j">
                                <f:if condition="{j.index} > 2">
                                    <f:then>
                                       <f:render section="ItemWrapper" arguments="{item: item, itemIndex: j.index}" />
                                    </f:then>
                                </f:if>
                            </f:for>
                        </div>
                    </div>
                </f:for>
            </div>

            <div class="sliders d-block d-tablet-none">
                <f:for each="{data.gallery_tab}" as="tab" iteration="i">
                    <div class="swiper{f:if(condition: '{i.isFirst}', then: ' active')}" data-gallery-id="{i.index}">
                        <div class="swiper-wrapper">
                            <f:variable name="isSlider" value="true"></f:variable>
                            <f:for each="{tab.gallery_item}" as="item" iteration="j">
                                <f:render section="ItemWrapper" arguments="{item: item, itemIndex: j.index, isSlider: isSlider}" />
                            </f:for>
                        </div>
                        <div class="swiper-pagination pagination-lines my-5 px-5"></div>
                    </div>
                </f:for>
            </div>
        </div>
    </f:section>

    <f:section name="ItemWrapper">
        <div class="item background-{item.background}{f:if(condition: '{isSlider}', then: ' swiper-slide')}"  style="--background: var(--{item.background});" data-item-id="{itemIndex}">
            <f:if condition="{item.link}">
                <f:then>
                    <f:link.typolink parameter="{item.link}">
                        <f:render section="ItemContent" arguments="{item: item}" />
                    </f:link.typolink>
                </f:then>
                <f:else>
                    <f:render section="ItemContent" arguments="{item: item}" />
                </f:else>
            </f:if>
        </div>
    </f:section>

    <f:section name="ItemContent">
        <f:if condition="{item.image_desktop} || {item.image_tablet} || {item.image_mobile}">
            <f:then>
                <div class="image">
                    <f:render partial="Image" arguments="{
                        images: {
                            desktop: item.image_desktop.0,
                            tablet: item.image_tablet.0,
                            mobile: item.image_mobile.0
                        }
                    }" />

                    <div class="caption">
                        <p class="title">{item.text}</p>
                    </div>
                </div>
            </f:then>
            <f:else>
                <div class="no-image">
                    <div class="text">
                        <p>{item.text}</p>
                    </div>
                    <div class="btnPrimary">
                        {item.link_text}
                    </div>
                </div>
            </f:else>
        </f:if>
    </f:section>
</html>
